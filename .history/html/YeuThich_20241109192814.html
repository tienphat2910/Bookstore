<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Danh sách yêu thích</title>
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;600;700&display=swap"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />
    <link rel="stylesheet" href="../css/bootstrap.css" />
    <link rel="stylesheet" href="../css/home-style.css" />
  </head>
  <body>
    <div class="container">
      <header class="d-flex justify-content-between align-items-center py-3">
        <div class="d-flex align-items-center">
          <!-- Hamburger Menu Icon -->
          <div class="dropdown">
            <button
              class="btn btn-light me-3"
              id="dropdownMenuButton"
              data-bs-toggle="dropdown"
              aria-expanded="false"
            >
              <i class="fas fa-bars"></i>
            </button>
            <!-- Dropdown Content -->
            <div class="dropdown-menu p-3" aria-labelledby="dropdownMenuButton">
              <h5 class="mb-3">Danh sách sản phẩm</h5>
              <div class="d-flex">
                <div class="me-4">
                  <h6 class="mt-3">
                    <a
                      href="DanhSachSanPham.html?category=foreign"
                      class="dropdown-item"
                    >
                      FOREIGN BOOKS
                    </a>
                  </h6>
                  <ul class="list-unstyled ms-3">
                    <li>
                      <a
                        href="DanhSachSanPham.html?category=foreign-children"
                        class="dropdown-item"
                      >
                        Children
                      </a>
                    </li>
                    <li>
                      <a
                        href="DanhSachSanPham.html?category=foreign-classic"
                        class="dropdown-item"
                      >
                        Classic
                      </a>
                    </li>
                    <li>
                      <a
                        href="DanhSachSanPham.html?category=foreign-bestseller"
                        class="dropdown-item"
                      >
                        Best seller
                      </a>
                    </li>
                    <li>
                      <a
                        href="DanhSachSanPham.html?category=foreign-fiction"
                        class="dropdown-item"
                      >
                        Fiction
                      </a>
                    </li>
                    <li>
                      <a
                        href="DanhSachSanPham.html?category=foreign-dictionaries"
                        class="dropdown-item"
                      >
                        Dictionaries
                      </a>
                    </li>
                    <li>
                      <a
                        href="DanhSachSanPham.html?category=foreign-comic"
                        class="dropdown-item"
                      >
                        Comic
                      </a>
                    </li>
                    <li>
                      <a
                        href="DanhSachSanPham.html?category=foreign-computing"
                        class="dropdown-item"
                      >
                        Computing
                      </a>
                    </li>
                    <li>
                      <a
                        href="DanhSachSanPham.html?category=foreign-technology"
                        class="dropdown-item"
                      >
                        Technology & Engineering
                      </a>
                    </li>
                    <li>
                      <a
                        href="DanhSachSanPham.html?category=foreign-history"
                        class="dropdown-item"
                      >
                        History
                      </a>
                    </li>
                  </ul>
                </div>
              </div>
            </div>
          </div>
          <!-- Logo -->
          <div class="logo">
            <a href="home.html">
              <img src="../img/logo.jpg" alt="Logo" class="logo-img" />
            </a>
          </div>
        </div>
        <!-- Search and Icons Part -->
        <div class="search-part">
          <input
            class="form-control me-2 search-input"
            type="text"
            placeholder="Search"
            aria-label="Search"
          />
          <!-- Add this div for search results -->
          <div
            id="search-results"
            class="row mt-3 search-results-container"
          ></div>
        </div>
        <div class="icons d-flex align-items-center">
          <div class="profile dropdown me-3">
            <img
              src="../img/user.png"
              alt="User"
              class="icon-outline-user dropdown-toggle"
              id="userDropdown"
              data-bs-toggle="dropdown"
              aria-expanded="false"
            />
            <ul
              class="custom-dropdown-menu user-dropdown-menu"
              aria-labelledby="userDropdown"
              id="userDropdownMenu"
              style="display: none"
            >
              <!-- Nội dung sẽ được JavaScript chèn vào -->
            </ul>
          </div>
          <div class="heart me-3">
            <a href="YeuThich.html">
              <img src="../img/heart.png" alt="Wishlist" class="heart-icon" />
            </a>
          </div>
          <div class="shop">
            <a href="GioHang.html">
              <img
                src="../img/cart.png"
                alt="Shopping Cart"
                class="icon-outline-shopping-cart"
              />
            </a>
          </div>
        </div>
      </header>

      <div class="wishlist-container my-5">
        <h2 class="mb-4">Danh sách yêu thích</h2>

        <!-- Sách Trong nước -->
        <div class="category-section mb-4">
          <h4 class="mb-3">Sách Trong nước</h4>
          <div class="row" id="domesticBooks">
            <!-- Sách trong nước sẽ được thêm vào đây -->
          </div>
        </div>

        <!-- FOREIGN BOOKS -->
        <div class="category-section mb-4">
          <h4 class="mb-3">FOREIGN BOOKS</h4>
          <div class="row" id="foreignBooks">
            <!-- Sách nước ngoài sẽ được thêm vào đây -->
          </div>
        </div>
      </div>

      <footer class="container py-5">
        <div class="row">
          <!-- Left Side -->
          <div class="col-md-4">
            <img src="../img/logo.jpg" alt="Logo" class="mb-3" width="150" />
            <p>Địa chỉ: 12 Nguyễn Văn Bảo, Phường 4, Gò Vấp, Hồ Chí Minh</p>
            <p>
              Bookstore nhận đặt hàng trực tuyến và giao hàng tận nơi. KHÔNG hỗ
              trợ đặt mua và nhận hàng trực tiếp tại văn phòng cũng như tất cả
              Hệ Thống Bookstore trên toàn quốc.
            </p>
            <div class="d-flex align-items-center">
              <img
                src="../img/logo-bo-cong-thuong-da-thong-bao1.webp"
                alt="Registered Logo"
                width="100"
              />
            </div>
            <div class="mt-3 d-flex">
              <!-- Social Media Icons -->
              <img
                src="../img/Facebook-on.webp"
                alt="Facebook"
                class="me-2"
                width="30"
              />
              <img
                src="../img/Insta-on.webp"
                alt="Instagram"
                class="me-2"
                width="30"
              />
              <img
                src="../img/Youtube-on.webp"
                alt="YouTube"
                class="me-2"
                width="30"
              />
            </div>
            <div class="mt-3 d-flex app-download-icons">
              <!-- App Download Icons -->
              <img src="../img/android1.webp" alt="Android" class="me-2" />
              <img src="../img/appstore1.webp" alt="App Store" />
            </div>
          </div>

          <!-- Right Side -->
          <div class="col-md-8">
            <div class="row">
              <!-- Column 1: DỊCH VỤ -->
              <div class="col-md-3">
                <h5>DỊCH VỤ</h5>
                <ul class="list-unstyled">
                  <li><a href="DieuKhoanSuDung.html">Điều khoản sử dụng</a></li>
                  <li>
                    <a href="ChinhSachBaoMatThongTinCaNhan.html"
                      >Chính sách bảo mật thông tin cá nhân</a
                    >
                  </li>
                  <li>
                    <a href="ChinhSachBaoMatThanhToan.html"
                      >Chính sách bảo mật thanh toán</a
                    >
                  </li>
                  <li><a href="GioiThieu.html">Giới thiệu Bookstore</a></li>
                </ul>
              </div>

              <!-- Column 2: HỖ TRỢ -->
              <div class="col-md-3">
                <h5>HỖ TRỢ</h5>
                <ul class="list-unstyled">
                  <li>
                    <a href="ChinhSachDoiTra.html"
                      >Chính sách đổi - trả - hoàn tiền</a
                    >
                  </li>
                  <li>
                    <a href="ChinhSachBaoHanh.html"
                      >Chính sách bảo hành - bồi hoàn</a
                    >
                  </li>
                  <li>
                    <a href="ChinhSachVanChuyen.html">Chính sách vận chuyển</a>
                  </li>
                  <li>
                    <a href="ChinhSachKhachSi.html">Chính sách khách sỉ</a>
                  </li>
                </ul>
              </div>

              <!-- Column 3: TÀI KHOẢN CỦA TÔI -->
              <div class="col-md-3">
                <h5>TÀI KHOẢN CỦA TÔI</h5>
                <ul class="list-unstyled">
                  <li><a href="login.html">Đăng nhập/Tạo mới tài khoản</a></li>
                  <li><a href="ChiTietTaiKhoan.html">Chi tiết tài khoản</a></li>
                  <li><a href="LichSuDonHang.html">Lịch sử mua hàng</a></li>
                </ul>
              </div>

              <!-- Column 4: LIÊN HỆ -->
              <div class="col-md-3">
                <h5>LIÊN HỆ</h5>
                <ul class="list-unstyled">
                  <li>
                    <i class="fa fa-map-marker me-2"></i>12 Nguyễn Văn Bảo,
                    Phường 4, Gò Vấp, Hồ Chí Minh
                  </li>
                  <li><i class="fa fa-envelope me-2"></i>cskh@gmail.com</li>
                  <li><i class="fa fa-phone me-2"></i>0376549230</li>
                </ul>
              </div>
            </div>

            <!-- Payment and Delivery Icons -->
            <div class="row mt-4">
              <div class="col text-center">
                <img
                  src="../img/icon_snappy1.webp"
                  alt="Snappy"
                  class="me-2"
                  width="50"
                />
                <img
                  src="../img/logo_lex.webp"
                  alt="LEX"
                  class="me-2"
                  width="50"
                />
                <img
                  src="../img/Logo_ninjavan.webp"
                  alt="Ninja Van"
                  class="me-2"
                  width="50"
                />
                <img
                  src="../img/vnpost1.webp"
                  alt="VNPost"
                  class="me-2"
                  width="50"
                />
                <img src="../img/ahamove_logo3.webp" alt="Ahamove" width="50" />
              </div>
              <div class="col text-center">
                <img
                  src="../img/momopay.webp"
                  alt="Momo"
                  class="me-2"
                  width="50"
                />
                <img
                  src="../img/vnpay_logo.webp"
                  alt="VNPay"
                  class="me-2"
                  width="50"
                />
                <img
                  src="../img/shopeepay_logo.webp"
                  alt="ShopeePay"
                  width="50"
                />
              </div>
            </div>

            <!-- Business Registration Information -->
            <p class="mt-4 text-center">
              Giấy chứng nhận Đăng ký Kinh doanh số 0304132047 do Sở Kế hoạch và
              Đầu tư Thành phố Hồ Chí Minh cấp ngày 20/12/2005, đăng ký thay đổi
              lần thứ 10, ngày 20/05/2022.
            </p>
            <p class="text-center">
              &copy; 2024 Your Company. All Rights Reserved.
            </p>
          </div>
        </div>
      </footer>
    </div>

    <script src="../js/jquery-3.7.1.min.js"></script>
    <script src="../js/bootstrap.js"></script>
    <script src="../js/bootstrap.bundle.js"></script>
    <script src="../js/home_script.js"></script>
    <script>
      let wishlist = JSON.parse(localStorage.getItem("wishlist")) || [];

      function displayWishlist() {
        const domesticContainer = document.getElementById("domesticBooks");
        const foreignContainer = document.getElementById("foreignBooks");

        // Phân loại sách
        const domesticBooks = wishlist.filter((item) => !item.isforeign);
        const foreignBooks = wishlist.filter((item) => item.isforeign);

        // Hiển thị sách trong nước
        if (domesticBooks.length === 0) {
          domesticContainer.innerHTML =
            '<p class="text-center col-12">Không có sách trong nước trong danh sách yêu thích</p>';
        } else {
          domesticContainer.innerHTML = createBookCards(domesticBooks);
        }

        // Hiển thị sách nước ngoài
        if (foreignBooks.length === 0) {
          foreignContainer.innerHTML =
            '<p class="text-center col-12">Không có sách nước ngoài trong danh sách yêu thích</p>';
        } else {
          foreignContainer.innerHTML = createBookCards(foreignBooks);
        }

        // Ẩn section nếu không có sách
        document.querySelectorAll(".category-section").forEach((section) => {
          const hasBooks =
            section.querySelector(".row").children.length > 0 &&
            !section.querySelector(".row").innerHTML.includes("Không có sách");
          section.style.display = hasBooks ? "block" : "none";
        });
      }

      function createBookCards(books) {
        return books
          .map(
            (item) => `
                <div class="col-md-3 mb-4">
                    <div class="card h-100">
                        <a href="ChiTietSanPham.html?id=${encodeURIComponent(
                          item.title
                        )}">
                            <img src="${
                              item.image
                            }" class="card-img-top" alt="${item.title}">
                        </a>
                        <div class="card-body">
                            <h5 class="card-title">${item.title}</h5>
                            <p class="card-text">${item.author}</p>
                            <p class="card-text text-primary">${item.price}</p>
                            <div class="d-flex justify-content-between">
                                <button class="btn btn-primary btn-sm" 
                                    onclick="addToCart('${JSON.stringify(
                                      item
                                    ).replace(/'/g, "\\'")}')">
                                    Thêm vào giỏ
                                </button>
                                <button class="btn btn-outline-danger btn-sm active" 
                                    onclick="removeFromWishlist('${
                                      item.title
                                    }')">
                                    <i class="fas fa-heart"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `
          )
          .join("");
      }

      // Thêm CSS
      const style = document.createElement("style");
      style.textContent = `
            .category-section {
                border-bottom: 1px solid #eee;
                padding-bottom: 2rem;
            }
            
            .category-section:last-child {
                border-bottom: none;
            }

            .category-section h4 {
                color: #333;
                font-weight: 600;
                position: relative;
                padding-left: 15px;
            }

            .category-section h4::before {
                content: '';
                position: absolute;
                left: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 4px;
                height: 20px;
                background-color: #0d6efd;
                border-radius: 2px;
            }
        `;
      document.head.appendChild(style);

      // Hàm xóa sản phẩm khỏi danh sách yêu thích
      function removeFromWishlist(title) {
        const index = wishlist.findIndex((item) => item.title === title);
        if (index !== -1) {
          wishlist.splice(index, 1);
          localStorage.setItem("wishlist", JSON.stringify(wishlist));
          alert("Đã xóa khỏi danh sách yêu thích!");
          displayWishlist();
          updateWishlistIcon();
        }
      }

      // Hàm thêm vào giỏ hàng
      function addToCart(itemStr) {
        const item = JSON.parse(itemStr);
        let cart = JSON.parse(localStorage.getItem("cart")) || [];
        const existingProduct = cart.find((p) => p.title === item.title);

        if (existingProduct) {
          existingProduct.quantity += 1;
        } else {
          cart.push({ ...item, quantity: 1 });
        }

        localStorage.setItem("cart", JSON.stringify(cart));
        alert("Đã thêm vào giỏ hàng!");
      }

      // Cập nhật số lượng trên icon wishlist
      function updateWishlistIcon() {
        const wishlistCount = wishlist.length;
        const heartIcon = document.querySelector(".heart-icon");
        if (heartIcon) {
          if (wishlistCount > 0) {
            heartIcon.classList.add("has-items");
          } else {
            heartIcon.classList.remove("has-items");
          }
        }
      }

      // Khởi tạo khi trang được load
      document.addEventListener("DOMContentLoaded", function () {
        displayWishlist();
        updateWishlistIcon();
      });
    </script>
  </body>
</html>
